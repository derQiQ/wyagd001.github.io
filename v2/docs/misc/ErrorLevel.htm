<!DOCTYPE HTML>
<html lang="zh">
<head>
<title>ErrorLevel - 定义 &amp; 使用 | AutoHotkey v2</title>
<meta name="description" content="ErrorLevel is a built-in variable that is set to indicate the success or failure of some of the functions." />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script type="text/javascript">$(function(){0<=window.navigator.userAgent.toLowerCase().indexOf("ucbrowser")&&CaoNiMaDeUc()})</script>
</head>

<body>
<h1>ErrorLevel</h1>

<p>这是一个内置变量, 用于指示某些内置函数的成功或失败(并非所有内置函数都会更改 ErrorLevel 的值). 值为 0 通常表示成功, 而其他值一般表示失败. 你也可以自己设置 ErrorLevel 的值.</p>
<p>每个<a href="Threads.htm">线程</a>均以 ErrorLevel 为 0 开始, 并保留其自己的 ErrorLevel 值, 这意味着如果<a href="Threads.htm">当前线程</a>被另一个线程中断, 则当原始线程恢复时, 它仍将具有其原来的 ErrorLevel 值, 而不是由中断线程所设置的 ErrorLevel 值.</p>
<p>尽管 ErrorLevel 通常包含一个数字(通常为 0 或 1), 但是脚本可以为其分配其他类型的值.</p>
<p class="note"><strong>注意</strong>: 由于某些内置函数会设置大于 1 的 ErrorLevel 值, 因此最好不要检查 ErrorLevel 是否为 1, 而应检查 ErrorLevel 是否不为 0.</p>
<p>下面的列表包含了会设置 ErrorLevel 的所有函数, 包括可能的 ErrorLevel 值:</p>
<table class="info">
    <tr><td><a href="../commands/Control.htm">Control 函数</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/DirCopy.htm">DirCopy</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/DirCreate.htm">DirCreate</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/DirDelete.htm">DirDelete</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/DirMove.htm">DirMove</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/DirSelect.htm">DirSelect</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/Download.htm">Download</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/Drive.htm">Drive 函数</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/EnvSet.htm">EnvSet</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileAppend.htm">FileAppend</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileCopy.htm">FileCopy</a></td><td>0, <em>n</em></td></tr>
    <tr><td><a href="../commands/FileCreateShortcut.htm">FileCreateShortcut</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileDelete.htm">FileDelete</a></td><td>0, <em>n</em></td></tr>
    <tr><td><a href="../commands/FileGetAttrib.htm">FileGetAttrib</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileGetShortcut.htm">FileGetShortcut</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileGetSize.htm">FileGetSize</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileGetTime.htm">FileGetTime</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileGetVersion.htm">FileGetVersion</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileInstall.htm">FileInstall</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileMove.htm">FileMove</a></td><td>0, <em>n</em></td></tr>
    <tr><td><a href="../commands/FileRead.htm">FileRead</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileRecycle.htm">FileRecycle</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileRecycleEmpty.htm">FileRecycleEmpty</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileSelect.htm">FileSelect</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/FileSetAttrib.htm">FileSetAttrib</a></td><td>0, <em>n</em></td></tr>
    <tr><td><a href="../commands/FileSetTime.htm">FileSetTime</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/GroupActivate.htm">GroupActivate</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/Hotkey.htm">Hotkey</a></td><td>0, 1, 2, 3, 4, 5, 6, 98, 99</td></tr>
    <tr><td><a href="../commands/IniDelete.htm">IniDelete</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/IniRead.htm">IniRead</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/IniWrite.htm">IniWrite</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/Input.htm">Input</a></td><td>NewInput, Max, Timeout, Match, EndKey:Name</td></tr>
    <tr><td><a href="../commands/InputBox.htm">InputBox</a></td><td>0, 1, 2</td></tr>
    <tr><td><a href="../commands/MenuSelect.htm">MenuSelect</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/PostMessage.htm">PostMessage</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/SendMessage.htm">SendMessage</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/RegDelete.htm">RegDelete</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/RegDeleteKey.htm">RegDeleteKey</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/RegRead.htm">RegRead</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/RegWrite.htm">RegWrite</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/SetWorkingDir.htm">SetWorkingDir</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/Sort.htm#unique">Sort: U option</a></td><td>0, <em>n</em></td></tr>
    <tr><td><a href="../commands/SoundGetInterface.htm">SoundGetInterface</a></td><td>0, <em>字符串</em></td></tr>
    <tr><td><a href="../commands/SoundGetMute.htm">SoundGetMute</a></td><td>0, <em>字符串</em></td></tr>
    <tr><td><a href="../commands/SoundGetName.htm">SoundGetName</a></td><td>0, <em>字符串</em></td></tr>
    <tr><td><a href="../commands/SoundGetVolume.htm">SoundGetVolume</a></td><td>0, <em>字符串</em></td></tr>
    <tr><td><a href="../commands/SoundPlay.htm">SoundPlay</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/SoundSetMute.htm">SoundSetMute</a></td><td>0, <em>字符串</em></td></tr>
    <tr><td><a href="../commands/SoundSetVolume.htm">SoundSetVolume</a></td><td>0, <em>字符串</em></td></tr>
    <tr><td><a href="../commands/StatusBarGetText.htm">StatusBarGetText</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/StatusBarWait.htm">StatusBarWait</a></td><td>0, 1, 2</td></tr>
    <tr><td><a href="../commands/WinGetText.htm">WinGetText</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/WinSetAlwaysOnTop.htm">WinSetAlwaysOnTop</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/WinMoveBottom.htm">WinMoveBottom</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/WinMoveTop.htm">WinMoveTop</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/WinSetEnabled.htm">WinSetEnabled</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/WinRedraw.htm">WinRedraw</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/WinSetStyle.htm">WinSetStyle / WinSetExStyle</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/WinSetRegion.htm">WinSetRegion</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/WinSetTransparent.htm">WinSetTransparent</a></td><td>0, 1</td></tr>
    <tr><td><a href="../commands/WinSetTransColor.htm">WinSetTransColor</a></td><td>0, 1</td></tr>
</table>
<h2>示例</h2>
<div class="ex" id="ExBasic">
<p><a href="#ExBasic">#1</a></p>
<pre>Focused := ControlGetFocus("Untitled - Notepad")
if ErrorLevel  <em>; 即不为空或 0.</em>
    MsgBox "The target window doesn't exist."
else
    MsgBox "Control with focus = " Focused</pre>
</div>
</body>
</html>